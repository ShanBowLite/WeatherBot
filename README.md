# WeatherBot
Telegram bot for personal weather broadcasting

# Launch
Для запуска бота необходимо запустить файл bot.py. Список библиотек для работы бота с указанием версий указан в конце описания, а также продублирован в файле requirements.txt.

# Documentation
Ниже приведено описание файлов проекта и реализованных в них методов и функций.\
\
Файл bot.py предназначен для запуска бота, его единственная функция main инициализирует бота, подключает роутеры и запускает метод start_polling.\
\
Файлы start_private.py и start_not_private.py, находящиеся в папке handlers, содержат реакции на все прописанные команды и сообщения пользователя. Все сообщения пользователя проходят через фильтр, содержащийся в файле chat_type.py, первый роутер (файл start_private.py) содержит настройку фильтра на приватную переписку, и все сообщения, отправленные из группы или канала, будут игнорироваться этим роутером и перенаправляться во второй роутер (файл start_not_private.py).\
\
В папке keyboards находятся файлы for_city.py, for_start.py и for_y_or_n.py, отвечающие за формирование интерактивных кнопок. Все файлы используют метод ReplyKeyboardBuilder.\
\
Файл for_start.py отвечает за формирование набора для главного меню, включающего следующие кнопки:\
•	«Указать город»\
•	«Узнать погоду»\
•	«Узнать прогноз на день»\
•	«Узнать прогноз на неделю»\
•	«Список доступных команд»\
•	«Узнать обо мне»\
\
Файл for_city.py отвечает за формирование меню выбора способа указания города, содержащего следующие кнопки:\
•	«Отправить геолокацию»\
•	«Указать вручную»\
\
Файл	for_y_or_n.py	отвечает	за	формирование	меню	выбора	ответа
«да»/«нет», содержащего соответствующие кнопки.\
Файл geocoding.py содержит метод определения координат по названию города, введеному вручную, и сохраняет данные в файл формата json.\
\
Файл reverse_geocoding.py содержит метод поиска названия города по данным геолокации и сохраняет данные в файл формата json.\
\
Файлы user.py, forecast_day.py и forecast_week.py содержат реализацию классов для пользователя, прогноза на день и прогноза на неделю соответственно.\
\
Файл weather_pars.py предоставляет функции для работы с HTML- страницами, полученными от веб-сайта gismeteo.ru, чтобы извлекать данные о погоде на день и на неделю. Файл содержит следующие функции:\
•	get_html: Данная функция отправляет HTTP-запрос на указанный URL и возвращает HTML-страницу в виде текста.\
•	get_html_week: аналогично первой функции, эта функция отправляет запрос на HTML-страницу, но предназначена для получения данных о погоде на неделю.\
•	save_html: сохраняет HTML-страницу в файл с указанным именем.\
•	read_html: читает HTML-страницу из файла с указанным именем и возвращает ее содержимое в виде текста.\
•	find_date: извлекает данные о погоде на день из HTML-страницы.
Создает объект Forecast, в котором сохраняются данные для каждого времени дня.\
•	find_date_week: функция извлекает данные о погоде на неделю. Создает объект Forecast_week с данными для каждого дня недели.\
•	str_forecast и str_forecast_week: Эти функции принимают объекты Forecast и Forecast_week соответственно и формируют читаемую строку с данными о погоде на день и на неделю.\
\
Файл bd.py содержит набор функций для взаимодействия с базой данных с использованием библиотеки pyodbc. Файл содержит следующие функции:\
•	add_user: добавляет нового пользователя в таблицу "Пользователи" в базе данных.\
•	delete_user: удаляет пользователя из таблицы "Пользователи" по заданному идентификатору.\
•	search_user: ищет пользователя в таблице "Пользователи" по заданному идентификатору и возвращает объект User с данными о пользователе.\
•	check_user: проверяет наличие пользователя в таблице "Пользователи" по заданному идентификатору.\
•	change_city: изменяет город пользователя в таблице "Пользователи" по заданному идентификатору.\
•	get_city_link: Получает ссылку на сайт gismeteo.ru с информацией о городе пользователя. Использует информацию о городе из таблицы "Пользователи" и выполняет запрос к таблице "Города" для получения соответствующей ссылки.\



# Libraries
aiofiles==23.1.0\
aiogram==3.1.1\
aiohttp==3.8.6\
aiosignal==1.3.1\
annotated-types==0.6.0\
async-generator==1.10\
async-timeout==4.0.3\
attrs==21.4.0\
beautifulsoup4==4.10.0\
bs4==0.0.1\
certifi==2023.7.22\
cffi==1.15.0\
charset-normalizer==2.0.12\
cryptography==36.0.2\
DateTime==5.2\
frozenlist==1.4.0\
h11==0.13.0\
idna==3.3\
lxml==4.8.0\
magic-filter==1.0.12\
multidict==6.0.4\
outcome==1.1.0\
pycparser==2.21\
pydantic==2.3.0\
pydantic_core==2.6.3\
pyOpenSSL==22.0.0\
PySocks==1.7.1\
pytz==2023.3.post1\
requests==2.27.1\
selenium==4.1.3\
sniffio==1.2.0\
sortedcontainers==2.4.0\
soupsieve==2.3.1\
trio==0.20.0\
trio-websocket==0.9.2\
typing_extensions==4.7.1\
urllib3==1.26.9\
wsproto==1.1.0\
yarl==1.9.2\
zope.interface==6.1\

